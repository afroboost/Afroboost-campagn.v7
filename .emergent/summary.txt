<analysis>**original_problem_statement:**
L'utilisateur souhaite créer une application nommée Afroboost pour la réservation de casques audio pour des cours de fitness. La demande a évolué pour inclure un mode coach avancé, un système de code promo, un gestionnaire de campagnes marketing, des fonctionnalités e-commerce, et plus récemment, une refonte de l'architecture pour un déploiement sur Vercel et la correction de bugs persistants.

**PRODUCT REQUIREMENTS:**
1.  **Système de Réservation Principal:** Les utilisateurs doivent pouvoir sélectionner un cours, une date, une offre et réserver.
2.  **E-commerce:** Le coach doit pouvoir créer et gérer des produits physiques avec des catégories, variantes, TVA, frais de port, et suivi.
3.  **Design Sombre & Néon:** L'application doit conserver son esthétique avec un fond noir et des éléments néon.
4.  **Mode Coach Secret:** Un panneau d'administration caché pour gérer le contenu, les cours, les offres, les produits et les réservations.
5.  **PWA:** L'application doit être installable sur mobile et desktop.
6.  **Architecture Vercel:** L'application doit être restructurée en composants React modulaires pour un déploiement sur Vercel.

**User's preferred language**: Français

**what currently exists?**
Une application full-stack avec un frontend React monolithique () et un backend FastAPI () utilisant des données en mémoire (non persistantes). L'agent a initié une restructuration majeure du frontend en créant une architecture de dossiers modulaire (, , , ) et un fichier , mais le code est toujours principalement dans . L'application inclut un flux de réservation, un mode coach avec gestion CRUD des offres (y compris un système multi-images), et un nouveau flux de récupération de mot de passe. Plusieurs bugs critiques signalés par l'utilisateur sont en cours de correction.

**Last working item**:
-   **Last item agent was working:** Préparation de l'application pour le déploiement sur Vercel en créant une architecture modulaire. L'agent a créé la structure de dossiers et les fichiers de configuration de base, et a vérifié que l'application fonctionnait toujours après ces changements.
-   **Status:** IN PROGRESS
-   **Agent Testing Done:** Y (A screenshot confirmed the app is running post-restructuring).
-   **Which testing method agent to use?** Frontend testing agent (pour valider le futur refactoring de  dans la nouvelle structure).
-   **User Testing Done:** N

**All Pending/In progress Issue list**:
-   **Issue 1:** Les images d'offres ajoutées par le coach n'apparaissent pas côté client (Priorité: P0).
-   **Issue 2:** Le défilement horizontal (swipe) des offres est bloqué ou non fluide (Priorité: P0).
-   **Issue 3:** Le scanner QR ne parvient pas à accéder à la caméra (Priorité: P1).
-   **Issue 4:** L'affichage des cartes d'offres est parfois coupé ou tronqué (Priorité: P1).

**Issues Detail:**
-   **Issue 1: Images d'offres non visibles côté client**
    -   **Attempted fixes:** L'agent a corrigé la logique pour utiliser  au lieu de . Il a découvert que les URLs d'images du coach renvoyaient une erreur 404 et les a remplacées par des images de test (), ce qui a fonctionné temporairement. L'utilisateur a confirmé via une vidéo que le problème persiste (les données ne se synchronisent pas correctement entre le mode coach et la vue client).
    -   **Next debug checklist:**
        1.  Analyser la gestion d'état () dans . Il y a une suspicion de conflit entre l'état  du  et celui de l'application principale.
        2.  S'assurer que lorsque le mode coach est quitté, les données des offres côté client sont bien rafraîchies ().
        3.  Valider que l'objet  envoyé à l'API depuis le formulaire coach contient bien le tableau  et que la réponse de l'API est correcte.
    -   **Why fix this issue and what will be achieved with the fix?** C'est une fonctionnalité clé pour la vente d'offres et de produits. La correction permettra d'afficher correctement les visuels gérés par le coach.
    -   **Status:** IN PROGRESS
    -   **Is recurring issue?** Y
    -   **Should Test frontend/backend/both after fix?** both
-   **Issue 2: Défilement horizontal des offres non fonctionnel**
    -   **Attempted fixes:** Plusieurs corrections CSS ont été appliquées, notamment , , et  pour améliorer le swipe sur mobile.
    -   **Next debug checklist:**
        1.  Vérifier dans l'inspecteur du navigateur que les classes CSS (, ) sont bien appliquées et non surchargées par d'autres règles.
        2.  Confirmer qu'aucun conteneur parent n'a une propriété  qui pourrait bloquer le défilement.
        3.  Tester sur une vue mobile pour s'assurer que les propriétés spécifiques à iOS () sont efficaces.
    -   **Why fix this issue and what will be achieved with the fix?** Améliore la navigation et l'expérience utilisateur, permettant de voir toutes les offres disponibles.
    -   **Status:** IN PROGRESS
    -   **Is recurring issue?** Y
    -   **Should Test frontend/backend/both after fix?** frontend
-   **Issue 3: Échec de l'accès à la caméra du scanner QR**
    -   **Attempted fixes:** L'agent a ajouté une logique pour forcer l'arrêt du flux de la caméra () avant d'en démarrer un nouveau. Un  a été ajouté pour gérer les erreurs. La dernière tentative incluait .
    -   **Next debug checklist:**
        1.  Tester la fonctionnalité sur un appareil réel pour confirmer que le flux de la caméra est bien libéré entre les tentatives.
        2.  Vérifier la console du navigateur pour des erreurs spécifiques liées à l'API .
        3.  S'assurer que le site est servi en HTTPS, une condition obligatoire pour .
    -   **Why fix this issue and what will be achieved with the fix?** Permet la validation rapide des tickets, une fonctionnalité essentielle pour le coach.
    -   **Status:** IN PROGRESS
    -   **Is recurring issue?** Y
    -   **Should Test frontend/backend/both after fix?** frontend

**In progress Task List**:
-   **Task 1: Refactoriser le monolithe  vers l'architecture modulaire (P0)**
    -   **Where to resume:** La structure de dossiers (, , , ) et  sont créés. Il faut maintenant commencer à extraire la logique et les composants de  dans les nouveaux fichiers.
    -   **What will be achieved with this?** Une codebase maintenable, scalable et prête pour le déploiement sur Vercel et l'ajout de nouvelles pages.
    -   **Status:** IN PROGRESS
    -   **Should Test frontend/backend/both after fix?** frontend

**Upcoming and Future Tasks**
*   **P1: Migration de la persistance des données vers une base de données réelle (MongoDB):** C'est la dette technique la plus critique. Le backend est une maquette qui perd toutes ses données à chaque redémarrage.
*   **P2: Créer des pages dédiées (ex: /boutique, /profil)** en utilisant le nouveau système de routage Vercel.
*   **P3: Implémenter l'envoi par Email et Instagram pour les Campagnes Marketing.**

**Completed work in this session**
-   **Architecture Vercel:** Mise en place d'une structure de dossiers modulaire (, , , ) et création du fichier  pour préparer le déploiement.
-   **Flux Mot de passe oublié:** Reconstruction complète du flux pour le mode coach, avec vérification par e-mail et formulaire de réinitialisation sécurisé, le tout stocké dans .
-   **Système d'images multiples:** Implémentation de la gestion jusqu'à 5 images par offre, avec édition, suppression et un carrousel côté client utilisant des points de navigation discrets.
-   **Champ d'adresse conditionnel:** Ajout d'un champ d'adresse de livraison qui n'apparaît que lors de la sélection d'un produit physique.
-   **Corrections de bugs multiples:** De nombreuses tentatives ont été faites pour corriger les problèmes récurrents d'affichage des cartes, de scroll horizontal et du scanner QR, avec application de règles CSS  et de logique JS ciblée.

**Earlier issues found/mentioned but not fixed**
Les problèmes listés dans **All Pending/In progress Issue list** sont tous des problèmes récurrents qui ont été mentionnés à plusieurs reprises par l'utilisateur et que l'agent a tenté de corriger sans succès définitif.

**Known issue recurrence from previous fork**
-   **Issue recurrence in previous fork:** Échec de l'accès à la caméra du scanner QR.
-   **Recurrence count:** Élevé (présent dans le handoff initial et signalé plusieurs fois dans cette session).
-   **Status:** IN PROGRESS

**Code Architecture**


**Key Technical Concepts**
-   **Frontend:** React (via CDN), TailwindCSS (utilisé via ), gestion d'état locale avec .
-   **Backend:** FastAPI (Python), servant de mock API avec des listes en mémoire.
-   **Architecture:** L'application est en transition d'une SPA monolithique vers une architecture modulaire pour Vercel.
-   **Persistence:**  pour l'authentification coach et les réservations. Aucune persistance côté backend.

**key DB schema**
-   Données en mémoire (non persistantes).
-   : 
-   : 

**All files of reference**
-   : Fichier principal contenant presque toute la logique frontend (à refactoriser).
-   : Fichier principal des styles, contient de nombreuses règles de correction.
-   : Fichier unique du backend.
-   : Fichier de configuration pour le routage sur Vercel.
-   : Décrit la nouvelle structure de code cible.

**Areas that need refactoring**:
-   **CRITICAL:** Le fichier  doit être décomposé de manière urgente dans la nouvelle structure de composants.
-   **CRITICAL:** Le backend doit être migré vers une base de données (ex: MongoDB) pour la persistance des données.
-   Le fichier  contient de nombreuses règles  et des duplications suite aux tentatives de correction. Il nécessite un nettoyage post-refactoring.

**key api endpoints**
-    (GET, POST, PUT, DELETE)
-    (POST)
-    (POST)

**Critical Info for New Agent**
-   **Toute communication doit être en français.**
-   **L'utilisateur est très directif et donne des instructions techniques précises.** Ses demandes sont la priorité absolue.
-   **Suivez les RÈGLES DE SÉCURITÉ** définies par l'utilisateur : ne pas toucher au Splash Screen, aux fichiers PWA (, ), ou à la logique de paiement.
-   **LES DONNÉES NE SONT PAS PERSISTANTES.** Le backend est une maquette.
-   La tâche principale est de poursuivre le **refactoring vers une architecture modulaire pour Vercel.**
-   **Email admin de référence:** 
-   **Accès Coach:** 3 clics rapides sur le copyright. Email: , MDP: .

**Last 10 User Messages and any pending HUMAN messages**
1.  **Utilisateur (dernière instruction):** Ordonne de passer à une architecture modulaire pour un déploiement Vercel et de ne plus travailler en mode monolithe.
2.  **Utilisateur:** Demande un vrai flux de Mot de passe oublié pour le mode coach, au lieu d'un lien .
3.  **Utilisateur:** Demande une correction du scanner QR (avec ) et du scroll horizontal ().
4.  **Utilisateur:** Répète les demandes de correction du scroll, des images tronquées, du scanner et du champ adresse.
5.  **Utilisateur:** Demande un swipe fluide avec des cartes à 85% de largeur et une correction du scanner.
6.  **Utilisateur:** Alerte que les images n'apparaissent toujours pas et demande une correction de la logique d'affichage ().
7.  **Utilisateur:** Alerte que seule une image s'affiche et demande un carrousel ou une galerie.
8.  **Utilisateur:** Envoie une capture d'écran montrant que les images sont cassées.
9.  **Utilisateur:** Alerte que les offres ne s'affichent plus du tout.
10. **Utilisateur:** Envoie une vidéo montrant que les images ajoutées par le coach n'apparaissent pas côté client.

**Project Health Check:**
-   **Broken:** La persistance des données est inexistante. Des fonctionnalités clés comme l'affichage des images, le scroll des offres et le scanner QR sont instables et signalées comme défectueuses de manière récurrente par l'utilisateur.
-   **Mocked:** L'intégralité du backend est une maquette.

**3rd Party Integrations**
-   : Pour la génération de QR codes.
-   : Pour le scan de QR codes via la caméra.

**Testing status**
-   **Testing agent used after significant changes:** NO (Non utilisé pour les dernières corrections de bugs ni pour la restructuration).
-   **Troubleshoot agent used after agent stuck in loop:** NO
-   **Test files created:** None
-   **Known regressions:** L'affichage des images, le scroll horizontal et le scanner QR sont des régressions ou des bugs persistants.

**Credentials to test flow:**
-   **Accès Coach:**
    -   **Déclencheur:** 3 clics rapides sur le copyright en pied de page.
    -   **Email:** 
    -   **Mot de passe:**  (peut avoir été changé par le flux de récupération).

**What agent forgot to execute**
-   L'agent a suivi les instructions de l'utilisateur de manière réactive, mais n'a pas réussi à résoudre de manière définitive les bugs récurrents (images, scroll, scanner). La cause racine (probablement liée à la gestion de l'état ou au rechargement des données) n'a pas été entièrement diagnostiquée et corrigée.
-   La tâche de fond la plus critique, la migration vers une base de données persistante, reste non traitée, ce qui est la source de nombreux problèmes potentiels de synchronisation des données.</analysis>
